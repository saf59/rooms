(function(e){function t(t){for(var a,i,o=t[0],u=t[1],c=t[2],p=0,f=[];p<o.length;p++)i=o[p],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);l&&l(t);while(f.length)f.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,o=1;o<n.length;o++){var u=n[o];0!==r[u]&&(a=!1)}a&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={app:0},s=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"3ccc":function(e,t,n){"use strict";var a=n("9dee"),r=n.n(a);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("span",{staticClass:"message"},[e._v(e._s(e.selectedInfo))]),n("form",{attrs:{id:"search"}},[e._v(" Search "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],attrs:{name:"query"},domProps:{value:e.searchQuery},on:{input:function(t){t.target.composing||(e.searchQuery=t.target.value)}}})]),n("grid",{attrs:{rooms:e.gridData,columns:e.gridColumns,"filter-key":e.searchQuery,selectedInfo:e.selectedInfo,parent:this}}),e.pageCount>1?n("vue_simple_pagination",{attrs:{"page-count":e.pageCount,"current-page":e.currentPage},on:{"page-changed":e.fetchData}}):e._e()],1)},s=[],i=(n("fb6a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",[n("thead",[n("tr",e._l(e.columns,(function(t){return n("th",{key:t,class:{active:e.sortKey===t},on:{click:function(n){return e.sortBy(t)}}},[e._v(" "+e._s(e._f("capitalize")(t))+" "),n("span",{staticClass:"arrow",class:e.sortOrders[t]>0?"asc":"dsc"})])})),0)]),n("tbody",e._l(e.filteredRooms,(function(t){return n("tr",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top.html.v-primary",modifiers:{hover:!0,top:!0,html:!0,"v-primary":!0}}],key:t.name,attrs:{title:t.details,variant:"outline-success"}},e._l(e.columns,(function(a){return n("td",{key:a,on:{click:function(n){return e.apply(t)}}},[e._v(" "+e._s(t[a])+" ")])})),0)})),0)])}),o=[],u=(n("4de4"),n("4160"),n("c975"),n("45fc"),n("4e82"),n("b0c0"),n("b64b"),n("159b"),{name:"grid",template:"#grid-template",props:{rooms:Array,columns:Array,filterKey:String,selectedInfo:String,parent:Object},data:function(){var e={};return this.columns.forEach((function(t){e[t]=1})),e[this.columns[0]]=-1,{sortKey:this.columns[0],sortOrders:e}},computed:{filteredRooms:function(){var e=this.sortKey,t=this.filterKey&&this.filterKey.toLowerCase(),n=this.sortOrders[e]||1,a=this.rooms;return t&&(a=a.filter((function(e){return Object.keys(e).some((function(n){return String(e[n]).toLowerCase().indexOf(t)>-1}))}))),e&&(a=a.slice().sort((function(t,a){return t=t[e],a=a[e],(t===a?0:t>a?1:-1)*n}))),a}},filters:{capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},methods:{apply:function(e){if("undefined"!==typeof Office.context.mailbox){var t=Office.context.mailbox.item;t.location.setAsync("The event will take place in: "+e["name"])}},sortBy:function(e){this.parent.fetchData(1),this.sortKey=e,this.sortOrders[e]=-1*this.sortOrders[e]},buildInfo:function(){return"Our service has selected 4 meeting rooms for you."}}}),c=u,l=(n("3ccc"),n("2877")),p=Object(l["a"])(c,i,o,!1,null,"7337e9d9",null),f=p.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vue-simple-pagination"},[e.moreThanOnePage?n("nav",[n("ul",{class:e.ulClass},[n("li",{class:e.getClass("previous")},[n("a",{attrs:{"aria-label":"Previous"},on:{click:function(t){e.setCurrentPage(Math.max(1,e.currentPage-1))}}},[n("span",{attrs:{"aria-hidden":"true"}},[e._v("«")])])]),e._l(e.pages,(function(t){return n("li",{key:t.number,class:e.getClass(t.number)},[t.number?n("a",{on:{click:function(n){return e.setCurrentPage(t.number)}}},[e._v(" "+e._s(t.number)+" ")]):e._e(),e.pageNull(t)?n("span",[e._v("...")]):e._e()])})),n("li",{class:e.getClass("next")},[n("a",{attrs:{"aria-label":"Next"},on:{click:function(t){e.setCurrentPage(Math.min(e.pageCount,e.currentPage+1))}}},[n("span",{attrs:{"aria-hidden":"true"}},[e._v("»")])])])],2)]):e._e()])},h=[],d=(n("a9e3"),{props:{currentPage:{required:!0,type:Number},pageCount:{required:!0,type:Number},ulClass:{default:"pagination"}},data:function(){return{pages:[]}},computed:{moreThanOnePage:function(){return this.buildPageList(),this.pageCount>1}},methods:{buildPageList:function(e){e||(e=this.currentPage),this.pages=[],this.pageCount>10?e>=7&&e<this.pageCount-4?(this.makePagesRange(1,2),this.pages.push({number:null}),this.makePagesRange(e-3,e+3),this.pages.push({number:null}),this.makePagesRange(this.pageCount-1,this.pageCount)):e<7?(this.makePagesRange(1,8),this.pages.push({number:null}),this.makePagesRange(this.pageCount-1,this.pageCount)):e>=this.pageCount-4&&(this.makePagesRange(1,2),this.pages.push({number:null}),this.makePagesRange(this.pageCount-5,this.pageCount)):this.makePagesRange(1,this.pageCount)},makePagesRange:function(e,t){for(var n=e;n<=t;n++)this.pages.push({number:n})},getClass:function(e){return e==this.currentPage?"active":null==e?"disabled":"previous"==e&&1==this.currentPage?"disabled":"next"==e&&this.currentPage==this.pageCount?"disabled":"clickable"},pageNull:function(e){return null==e.number},setCurrentPage:function(e){this.currentPage!=e&&(this.$emit("page-changed",e),this.buildPageList(e))}}}),m=d,b=(n("e76b"),Object(l["a"])(m,g,h,!1,null,"97f3f2d4",null)),v=b.exports,y=n("bc3a"),P=n.n(y),_={components:{grid:f,vue_simple_pagination:v},data:function(){return{searchQuery:"",selectedInfo:"",gridColumns:["rate","name","capacity"],gridData:[],allData:[],pageCount:0,currentPage:1,pageSize:5}},methods:{fetchData:function(e){this.currentPage=e;var t=(e-1)*this.pageSize,n=t+this.pageSize;console.log(e,t,n),this.gridData=this.allData.slice(t,n)}},mounted:function(){var e=this;P.a.get("/goodRooms.json").then((function(t){e.allData=t.data,e.selectedInfo="Our service has selected "+e.allData.length+" meeting rooms for you.",e.pageCount=e.allData.length/e.pageSize+1,e.currentPage=1,e.fetchData(1)}))}},C=_,O=(n("b480"),Object(l["a"])(C,r,s,!1,null,null,null)),k=O.exports,w=n("5f5b");function x(){new a["default"]({render:function(e){return e(k)}}).$mount("#app")}a["default"].config.productionTip=!1,a["default"].use(w["a"]),"localhost"===location.hostname?x():window.Office.initialize=function(){return x()}},"779c":function(e,t,n){},"9dee":function(e,t,n){},b480:function(e,t,n){"use strict";var a=n("fb1a"),r=n.n(a);r.a},e76b:function(e,t,n){"use strict";var a=n("779c"),r=n.n(a);r.a},fb1a:function(e,t,n){}});
//# sourceMappingURL=app.3692f7a3.js.map